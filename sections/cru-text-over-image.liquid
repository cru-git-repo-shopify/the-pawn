{%  assign width = 100 | divided_by: section.settings.number_of_columns | round %}
<style>
    #section-{{ section.id }} .cru_text_over_image_grid {
        display: grid;
        grid-template-columns: repeat({{ section.settings.number_of_columns }}, 1fr);
    }
    #section-{{ section.id }} .cru_text_over_image_item {
        height: 410px;
        background-size: cover;
        background-position: top;
        position: relative;
        transition: all 0.3s ease;
        overflow: hidden;
    }
    .cru_text_over_image_content {
        text-align: center;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
    #section-{{ section.id }} .cru_text_over_image_overlay {
        position: absolute;
        display: block;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: {{ section.settings.overlay_color }};
        opacity: {{ section.settings.overlay_opacity }};
        transition: background-color 0.3s ease, opacity 0.3s ease;
    }
    #section-{{ section.id }} .cru_text_over_image_item:hover .cru_text_over_image_overlay {
        background-color: {{ section.settings.hover_overlay_color }};
        opacity: {{ section.settings.overlay_opacity }};

    }
    #section-{{ section.id }} .cru_text_over_image_background {
        position: absolute;
        display: block;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: top;
        transition: transform 0.3s ease;
    }
    #section-{{ section.id }} .cru_text_over_image_item:hover .cru_text_over_image_background{
        transform: scale(1.2);
    }
    .cru_text_over_image_item a.button {
        margin-top: 30px;
    }
</style>
<div id="section-{{ section.id }}" class="cru_text_over_image {{ section.settings.class }}">
    <div class="cru_text_over_image_grid grid_columns_{{ section.settings.number_of_columns }}">
        {% for block in section.blocks %}
            <div class="cru_text_over_image_item {{ block.settings.class }}">
                <div class="cru_text_over_image_background" style="background-image: url({{ block.settings.image | img_url: 'master' }});"></div>
                <div class="cru_text_over_image_overlay">
                </div>
                <div class="cru_text_over_image_content">
                    {% if block.settings.heading != blank %}
                        <h2 style="color: {{ block.settings.heading_color }};">{{ block.settings.heading }}</h2>
                    {% endif %}
                    {% if block.settings.subheading != blank %}
                        <p style="color: {{ block.settings.subheading_color }};">{{ block.settings.subheading }}</p>
                    {% endif %}
                    {% if block.settings.url != blank and block.settings.link_text != blank %}
                        <a href="{{ block.settings.url }}" class="button" style="color: {{ block.settings.link_text_color }}; background-color: {{ block.settings.link_bg_color }}; border-color: {{ block.settings.link_border_color }};" onmouseover="this.style.color='{{ block.settings.link_hover_text_color }}'; this.style.backgroundColor='{{ block.settings.link_hover_bg_color }}'; this.style.borderColor='{{ block.settings.link_hover_border_color }}';" onmouseout="this.style.color='{{ block.settings.link_text_color }}'; this.style.backgroundColor='{{ block.settings.link_bg_color }}'; this.style.borderColor='{{ block.settings.link_border_color }}';">{{ block.settings.link_text }}</a>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{%  schema  %}
{
    "name": "CRU Text Over Image",
    "class": "cru_text_over_image",
    "tag": "div",
    "settings": [
        {
            "type": "text",
            "id": "class",
            "label": "Class"
        },
        {
            "type": "color",
            "id": "overlay_color",
            "label": "Overlay Color",
            "default": "#000000"
        },
        {
            "type": "color",
            "id": "hover_overlay_color",
            "label": "Hover Overlay Color",
            "default": "#ffffff"
        },
        {
            "type": "number",
            "id": "overlay_opacity",
            "label": "Overlay Opacity",
            "default": 0
        },
        {
            "type": "number",
            "id": "number_of_columns",
            "label": "Number of Columns",
        }

    ],
    "blocks": [
        {
            "type": "grid_item",
            "name": "Grid Item",
            "settings": [
                {
                    "type": "text",
                    "id": "class",
                    "label": "Class"
                },
                {
                    "type": "image_picker",
                    "id": "image",
                    "label": "Image"
                },
                {
                    "type": "text",
                    "id": "heading",
                    "label": "Heading"
                },
                {
                    "type": "color",
                    "id": "heading_color",
                    "label": "Heading Color",
                    "default": "#ffffff"
                },
                {
                    "type": "textarea",
                    "id": "subheading",
                    "label": "Subheading",
                },
                {
                    "type": "color",
                    "id": "subheading_color",
                    "label": "Subheading Color",
                    "default": "#ffffff"
                },
                {
                    "type": "url",
                    "id": "url",
                    "label": "Button URL"
                },
                {
                    "type": "text",
                    "id": "link_text",
                    "label": "Button Text"
                },
                {
                    "type": "color",
                    "id": "link_text_color",
                    "label": "Button Text Color",
                    "default": "#ffffff"
                },
                {
                    "type": "color",
                    "id": "link_hover_text_color",
                    "label": "Button Hover Text Color",
                    "default": "transparent"
                },
                {
                    "type": "color",
                    "id": "link_bg_color",
                    "label": "Button Background Color",
                    "default": "transparent"
                },
                {
                    "type": "color",
                    "id": "link_hover_bg_color",
                    "label": "Button Hover Background Color",
                    "default": "#ffffff"
                },
                {
                    "type": "color",
                    "id": "link_border_color",
                    "label": "Button Border Color",
                    "default": "#ffffff"
                },
                {
                    "type": "color",
                    "id": "link_hover_border_color",
                    "label": "Button Hover Border Color",
                    "default": "#ffffff"
                }  
            ]
        }
    ],
    "presets": [
        {
            "name": "CRU Text Over Image",
            "category": "Custom"
        }
    ]
}
{% endschema %}